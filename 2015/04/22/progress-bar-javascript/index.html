<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Create a YouTube-like page load progress plugin in 30 lines of JavaScript &middot; Lab
    
  </title>

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon.png">
  <link rel="shortcut icon" href="/public/favicon.png">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Lab
        </a>
      </h1>
      <p class="lead">Follow experiments on HTML5 and inpirations of different stuff By <a href="https://twitter.com/moinism" target="_blank">@moinism</a></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>
      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
      <a class="sidebar-nav-item" target="_blank" href="http://feeds.feedburner.com/moinlab">Subscribe</a>
      <a class="sidebar-nav-item" href="https://github.com/moinism/Lab">on GitHub</a>

    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>

<style type="text/css">
.btn {
  background-color:#6a9fb5;
  -moz-border-radius:28px;
  -webkit-border-radius:28px;
  border-radius:28px;
  display:inline-block;
  cursor:pointer;
  color:#ffffff !important;
  font-family:Arial;
  font-size:17px;
  padding:16px 31px;
  text-decoration:none;
  /*text-shadow:0px 1px 0px #2f6627;*/
}
</style>
<link rel="stylesheet" href="/public/css/poole.css">
<link rel="stylesheet" href="/public/css/syntax.css">
<link rel="stylesheet" href="/public/css/hyde.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Create a YouTube-like page load progress plugin in 30 lines of JavaScript</h1>
  <time datetime="2015-04-22 00:00:00 +0500" class="post-date">22 Apr 2015</time>
  <p>Most of you would have probably seen the very thin, page load progress showing bar on top of websites like YouTube, Medium and many others.</p>

<p>In this post, I&#39;ll try to create a plugin to show a loading bar which could be used for anything.</p>

<p><a href="/demo/load-progress/" class="btn">Demo</a> <a href="https://github.com/moinism/LoadingBar" class="btn">Source</a></p>

<h2>How it works</h2>

<p>Its simple. An element in <code>body</code> or anywhere on the page which would have its <code>position</code> to be <code>fixed</code> at <code>top: 0px;</code>. Its <code>width</code> would show the page load progress.</p>

<p>But we&#39;ll add the element and set its style with JavaScript once the page has loaded.</p>

<p><strong>Note:</strong>
Again, I&#39;m not using jQuery here and will using pure JavaScript.</p>

<p>Let&#39;s listen to the <code>DOMContentLoaded</code> <a href="https://lab.moin.im/2015/04/21/detect-page-load-javascript/">event to detect when page&#39;s DOM has loaded</a>.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// create a div</span>
    <span class="kd">var</span> <span class="nx">loadingBar</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s1">&#39;div&#39;</span> <span class="p">);</span>

    <span class="c1">// set its id so we could access it later</span>
    <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;loadingbar&#39;</span><span class="p">;</span>

    <span class="c1">// Give it some CSS</span>
    <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s1">&#39;position:fixed;top:0;left:0;display:block;height:1px;width:0%;background:#00B8D4;transition:1s width;-webkit-transition:1s width;-moz-transition:1s width;-ms-transition:1s width;z-index:99999&#39;</span><span class="p">;</span>

    <span class="c1">// Finally, append it to HTML</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">loadingBar</span> <span class="p">);</span>
<span class="p">});</span></code></pre></div>

<p>So, here is what we did in the code above:</p>

<ul>
<li>Created an empty <code>div</code> element</li>
<li>We assigned it an <code>id</code> so it would easier for access later</li>
<li>As I mentioned in start, the element needs some style. We added the basic CSS.</li>
<li>Now as the element is ready, we added it to the <code>body</code> element.</li>
</ul>

<h2>CSS in clean form</h2>

<p>To make it easier for you to understand what we added to the element.</p>

<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nt">position</span><span class="o">:</span> <span class="nt">fixed</span><span class="o">;</span>
<span class="nt">top</span><span class="o">:</span> <span class="nt">0px</span><span class="o">;</span>
<span class="nt">left</span><span class="o">:</span> <span class="nt">0px</span><span class="o">;</span>

<span class="nt">display</span><span class="o">:</span> <span class="nt">block</span><span class="o">;</span>
<span class="nt">height</span><span class="o">:</span> <span class="nt">1px</span><span class="o">;</span>
<span class="nt">width</span><span class="o">:</span> <span class="nt">0</span><span class="o">%;</span>
<span class="nt">background</span><span class="o">:</span> <span class="nf">#00B8D4</span><span class="o">;</span>

<span class="c">/* Bit of animation */</span>
<span class="nt">transition</span><span class="o">:</span> <span class="nt">1s</span> <span class="nt">width</span><span class="o">;</span>
<span class="nt">-webkit-transition</span><span class="o">:</span> <span class="nt">1s</span> <span class="nt">width</span><span class="o">;</span>
<span class="nt">-moz-transition</span><span class="o">:</span> <span class="nt">1s</span> <span class="nt">width</span><span class="o">;</span>
<span class="nt">-ms-transition</span><span class="o">:</span> <span class="nt">1s</span> <span class="nt">width</span><span class="o">;</span>

<span class="c">/* This is supposed to keep it on top of other elements */</span>
<span class="nt">z-index</span><span class="o">:</span> <span class="nt">99999</span><span class="o">;</span></code></pre></div>

<h3>Change Progress</h3>

<p>Now that our element is in DOM. We can change its width to change the progress.</p>

<p>we can do something like:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">loadingBar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="s1">&#39;10%&#39;</span><span class="p">;</span></code></pre></div>

<h3>Plugin code</h3>

<p>Now, here is this code turned into a complete plugin:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">loadingBar</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">el</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span> <span class="s1">&#39;div&#39;</span> <span class="p">);</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;loadingbar&#39;</span><span class="p">;</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s1">&#39;position:fixed;top:0;left:0;display:block;height:1px;width:60%;background:#00B8D4;transition:1s width;-webkit-transition:1s width;-moz-transition:1s width;-ms-transition:1s width;z-index:99999&#39;</span><span class="p">;</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span> <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span> <span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">setProgress</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">p</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span> <span class="nx">p</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">p</span> <span class="o">&lt;=</span> <span class="mi">100</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">p</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">;</span>
                <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="c1">// alias of setProgress</span>
        <span class="nx">prog</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">p</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">setProgress</span><span class="p">(</span> <span class="nx">p</span> <span class="p">)</span>
        <span class="p">},</span>
        <span class="nx">inc</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">pNow</span> <span class="o">=</span> <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">setProgress</span><span class="p">(</span> <span class="o">++</span><span class="nx">pNow</span> <span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">dec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">pNow</span> <span class="o">=</span> <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">setProgress</span><span class="p">(</span> <span class="o">--</span><span class="nx">pNow</span> <span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">color</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">clr</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">clr</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">height</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">h</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">loadingBar</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">onChange</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">val</span> <span class="p">)</span> <span class="p">{}</span>
    <span class="p">}</span></code></pre></div>

<h3>Plugin Usage</h3>

<p>Just call <code>loadingBar.init();</code> after <code>DOMContentLoaded</code>.</p>

<p><strong>Methods:</strong></p>

<p><code>setProgress, prog</code>: Pass an integer between 0 &amp; 100 to set the progress of bar</p>

<p><code>inc</code>: Increment progress by 1</p>

<p><code>dec</code>: Decrement progress by 1</p>

<p><code>color</code>: Pass HEX color code to change the color of bar. Do not pass the #</p>

<p><code>height</code>: Pass an integer to change height of bar.</p>

<p><strong>Examples:</strong></p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">loadingBar</span><span class="p">.</span><span class="nx">prog</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span> <span class="c1">// Bring progress bar at half</span>

<span class="nx">loadingBar</span><span class="p">.</span><span class="nx">color</span><span class="p">(</span><span class="s1">&#39;e1e1e1&#39;</span><span class="p">)</span> <span class="c1">// Change the color of bar</span></code></pre></div>


  <h2>Thoughts or Suggestions:</h2>
  <div id="disqus_thread"></div>
</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/04/21/detect-page-load-javascript/">
            How to detect when page has loaded with JavaScript
            <small>21 Apr 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/03/18/page-scroll-progress/">
            Page scroll progress with JavaScript
            <small>18 Mar 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/03/17/material-design-labels-css/">
            Creating material design labels with CSS
            <small>17 Mar 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>
<script type="text/javascript">
    var disqus_shortname = 'moinslab';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
    </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-46702057-9', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>
